<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>
	<!-- 修改上传文件的大小限制 -->
	<!-- 在default.properties中字段struts.multipart.maxSize=2097152 -->
	<!-- 设置上传的总大小为8MB -->
	<constant name="struts.multipart.maxSize" value="8388608"></constant>
	<constant name="struts.devMode" value="true"></constant>

	<package name="p1" extends="struts-default">
		<!-- 配置拦截器 -->
	    <interceptors>
	    	<!-- 登录拦截器 -->
<!-- 	        <interceptor name="loginIntercepter" class="com.school.intercepter.LoginIntercepter"></interceptor>
	        <interceptor name="encodingIntercepter" class="com.school.intercepter.EncodingIntercepter"></interceptor> -->
		    <!-- 自定义拦截器栈,拦截所有动作 
	            AbstractInterceptor的子类MethodFilterInterceptor可以指定哪些方法要被拦截器拦截或不拦截
	                excludeMethods:指定哪些方法不被过滤
	                includeMethods:指定哪些方法要被过滤 -->
	        <interceptor-stack name="myStack">
	            <!-- 引用默认拦截器栈 -->
<!-- 	            <interceptor-ref name="encodingIntercepter"></interceptor-ref> -->
	            <interceptor-ref name="defaultStack"></interceptor-ref>
<!-- 	            <interceptor-ref name="loginIntercepter">
	            	<param name="excludeMethods">register,login,isExistEmail</param>
	            </interceptor-ref> -->
	        </interceptor-stack>
	    </interceptors>
	    
	    <!-- 配置默认拦截器 -->
	    <default-interceptor-ref name="myStack"></default-interceptor-ref>
	
		<action name="registerUser" class="userAction" method="register">
			<result name="addSuccess" type="chain">queryByPageUser</result>
			<result name="registerSuccess">/Reception/RegistSuccess.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
			<interceptor-ref name="myStack">
				<param name="fileUpload.allowedExtensions">jpg</param>
				<param name="fileUpload.allowedTypes">image/jpg,image/jpeg</param>
			</interceptor-ref>
		</action>
		<action name="loginUser" class="userAction" method="login">
			<result name="success" type="redirect">/Reception/Home.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="logoutUser" class="userAction" method="logout">
			<result name="success" type="redirect">/Reception/Home.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="modifyUser" class="userAction" method="modify">
			<result name="success">/Backstage/gerenzhongxin.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="queryByPageUser" class="userAction" method="queryByPage">
			<result name="success">/Backstage/yonghuguanli.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="queryByNumberUser" class="userAction" method="queryByNumber">
			<result name="success">/Backstage/userInfo.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="getIconUser" class="userAction" method="getIcon">
		</action>
		
		
		<action name="queryByPageNotice" class="noticeAction" method="queryByPage">
			<result name="success">/Backstage/gonggaoguanli.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="queryByIdNotice" class="noticeAction" method="queryById">
			<result name="success" type="redirect">/Reception/Template.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="addNotice" class="noticeAction" method="add">
			<result name="success" type="chain">queryByPageNotice</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="removeNotice" class="noticeAction" method="remove">
			<result name="success" type="chain">queryByPageNotice</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="getFileNotice" class="noticeAction" method="getFile">
			<result name="success" type="stream">
                <!-- 将动作中的输入流get方法去除“get”后首字符小写的字符串 -->
                <param name="inputName">inputStream</param>
                <!-- 设置响应消息头，告诉浏览器以下载方式打开，设置文件名    OGNL表达式：${fileName} -->
                <param name="contentDisposition">attachment;filename=${fileName}</param>
                <!-- 设置响应消息头，告诉浏览器响应正文的mime类型 -->
                <param name="contentType">application/octet-stream</param>
            </result>
		</action>
		
		
		<action name="queryAllDailyActivity" class="dailyActivityAction" method="queryAll">
			<result name="success">richanghuodong.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="queryDailyActivity" class="dailyActivityAction" method="queryAll">
			<result name="success" type="redirect">/Reception/Activity1.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="addDailyActivity" class="dailyActivityAction" method="add">
			<result name="success" type="chain">queryAllDailyActivity</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="removeDailyActivity" class="dailyActivityAction" method="remove">
			<result name="success" type="chain">queryAllDailyActivity</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		
		
		<action name="addFile" class="fileAction" method="add">
			<result name="success" type="chain">queryByPageFile</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="removeFile" class="fileAction" method="remove">
			<result name="success" type="chain">queryByPageFile</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="queryByPageFile" class="fileAction" method="queryByPage">
			<result name="success">wenjianguanli.jsp</result>
			<result name="fail" type="redirect">/fail.jsp</result>
		</action>
		<action name="downloadFile" class="fileAction" method="download">
			<result name="success" type="stream">
                <!-- 将动作中的输入流get方法去除“get”后首字符小写的字符串 -->
                <param name="inputName">inputStream</param>
                <!-- 设置响应消息头，告诉浏览器以下载方式打开，设置文件名    OGNL表达式：${fileName} -->
                <param name="contentDisposition">attachment;filename=${fileName}</param>
                <!-- 设置响应消息头，告诉浏览器响应正文的mime类型 -->
                <param name="contentType">application/octet-stream</param>
            </result>
		</action>
	</package>
</struts>